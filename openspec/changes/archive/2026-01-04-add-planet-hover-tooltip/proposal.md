# Proposal: add-planet-hover-tooltip

## Summary

为星盘组件添加行星悬停提示面板，当用户将鼠标悬停在星盘上的行星符号时，显示一个固定宽度、动态高度的信息面板，包含行星详情、星座位置、宫位信息和关键相位。

## Motivation

当前星盘组件仅显示行星符号，用户无法快速获取行星的详细信息。添加悬停提示可以：

1. **提升信息可达性**：用户无需离开星盘即可查看行星详情
2. **增强交互体验**：通过视觉化的悬停面板提供更丰富的上下文信息
3. **支持学习理解**：显示行星关键词帮助用户理解每颗行星的象征意义

## Scope

### In Scope

1. **悬停面板组件**（PlanetTooltip）
   - 固定宽度（中文 280px / 英文 340px），动态高度
   - 宽度设计原则：确保相位信息（最长情况）可在单行显示，不换行
   - 跟随鼠标位置显示，智能避免超出视口边界
   - 支持明暗主题适配

2. **显示内容**
   - 行星标识：SVG 图标 + 名称 + [顺行/逆行] + 关键词/关键句
   - 星座位置：「落在」+ 星座名（带颜色）+ 星座符号 + 度数分
   - 宫位信息：「位于」+ 宫位编号 + 宫 + （若为宫主星）「守护」+ 宫位编号 + 宫
   - 关键相位列表：「和」+ 行星名 + 符号 + 「成」+ 角度 + 相位符号 + [入相/出相] + orb

3. **对比盘支持**
   - 行运盘（transit）：外环行星显示为「外环+行星名」
   - 合盘（synastry）：外环行星显示为「外环+行星名」
   - 相位信息中区分内外环来源

4. **国际化（i18n）**
   - 中英双语支持所有文案
   - 行星关键词需中英双语

### Out of Scope

- 点击行星触发的详情模态框
- 行星之间的连线悬停提示（相位线 tooltip）
- 移动端触摸交互（本次仅支持鼠标悬停）

## Technical Approach

### 数据扩展

扩展 `constants.ts` 中的 `TECH_DATA.PLANETS`，为每颗行星添加 `keywords` 字段：

```typescript
TECH_DATA.PLANETS = {
  'Sun': {
    glyph: '☉',
    color: '#FF6B6B',
    keywords: { zh: '自我、意志、生命力', en: 'Self, Will, Vitality' }
  },
  // ...
}
```

### 组件实现

1. 在 `AstroChart.tsx` 中为行星 `<g>` 元素添加 `onMouseEnter` 和 `onMouseLeave` 事件
2. 创建 `PlanetTooltip` 组件渲染悬停面板
3. 使用 React Portal 将 tooltip 渲染到 body，避免 SVG overflow 裁剪
4. 通过 CSS transition 实现淡入淡出动画

### 样式设计

参考图片设计稿：
- 背景色：暗色主题下半透明深色，明色主题下白色
- 行星名使用行星对应颜色
- 星座名使用星座对应颜色
- 相位中的行星名根据来源（内/外环）使用不同颜色
- 角度数字根据相位类型使用对应颜色（如红色=刑冲、绿色=三分）

## Alternatives Considered

1. **固定位置面板**：考虑将面板固定在星盘左上角显示，但用户选择了跟随鼠标方式以获得更直观的体验
2. **使用现有 AI 内容作为关键词来源**：数据不稳定且需要异步加载，选择使用静态配置更可靠
3. **新建独立配置文件**：考虑到关键词与行星元数据紧密相关，选择扩展现有 TECH_DATA 更合理

## Success Criteria

1. 悬停面板在鼠标进入行星符号时在 200ms 内显示
2. 面板内容完整显示所有规定信息
3. 对比盘中能正确区分内外环行星
4. 中英文切换时面板内容正确翻译
5. 明暗主题下面板样式正确适配

## Dependencies

- 无外部依赖
- 使用现有的 `useTheme` hook 进行主题适配
- 使用现有的 `useLanguage` context 进行国际化
