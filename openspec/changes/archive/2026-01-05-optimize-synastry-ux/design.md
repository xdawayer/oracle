# 合盘体验优化 - 设计决策

## 1. 术语通俗化策略

### 问题
当前合盘使用大量专业占星术语（如"敏感面板/修复窗口/微型循环图"），对普通用户过于晦涩。

### 决策
- **中文模式**：使用通俗易懂的表述，优先可理解性。
- **英文模式**：保留原有专业术语，面向有占星背景的用户。

### 术语映射表

| 原术语 | 中文通俗化 | 英文保留 |
|--------|------------|----------|
| 敏感面板 | 情感敏感区 | Sensitivity Panel |
| 修复窗口 | 最佳沟通时机 | Repair Window |
| 修复脚本 | 沟通话术 | Repair Script |
| 微型循环图 | 互动模式 | Cycle Diagram |
| 滋养点 | 相处加分项 | Nourishing Points |
| 触发点 | 容易踩雷的地方 | Trigger Points |
| 本命脚本 | 情感底色 | Natal Script |
| 业力挑战 | 成长功课 | Karmic Challenges |

### 理由
- 用户群体为普通大众，非专业占星爱好者。
- 产品定位为"心理自我探索"，非"占星预测"。
- 通俗表述更符合产品调性。

---

## 2. AI 姓名替换策略

### 问题
AI 生成内容中大量使用 "A" 和 "B" 代称，缺乏个性化体验。

### 决策
采用 **Prompt 优先 + 前端兜底** 策略：

1. **Prompt 层**：
   - 在 context 中传入 `nameA` 和 `nameB`。
   - 在 system prompt 中明确要求："请使用 {nameA} 和 {nameB} 代替 A 和 B"。

2. **前端兜底**：
   - 若 AI 输出仍包含 "A " 或 " B " 等模式，进行字符串替换。
   - 替换规则：`/\bA\b/g` → nameA，`/\bB\b/g` → nameB。
   - 仅替换独立的 A/B，避免误替换单词中的字母。

3. **缓存策略**：
   - 已缓存的 AI 响应不做替换，保持一致性。
   - 新生成的响应执行兜底替换。

### 理由
- Prompt 优化是根本解决方案，成功率高。
- 前端兜底处理 AI 偶发不遵循指令的情况。
- 避免对历史数据造成破坏性更新。

---

## 3. 排版格式规范

### 参考标准
以"探索自我"模块为基准，统一以下规范：

| 元素 | 规范 |
|------|------|
| Section 标题 | `text-lg font-bold uppercase tracking-widest` |
| 卡片标题 | `text-sm font-bold uppercase text-accent` |
| 正文 | `text-base leading-relaxed` |
| 辅助说明 | `text-sm opacity-60` |
| Section 间距 | `mt-8` 或 `space-y-8` |
| 卡片内边距 | `p-6` |
| 星盘下方间距 | `mb-8` |

### 对比盘敏感面板改造

**Before（5 列紧凑网格）**：
```
[月亮] [金星] [火星] [水星] [深层]
```

**After（垂直卡片布局）**：
```
┌─────────────────────────────┐
│ 🌙 月亮 · 情感安全区        │
│ 模式：...                   │
│ 恐惧：...                   │
│ 需求：...                   │
└─────────────────────────────┘
┌─────────────────────────────┐
│ ♀ 金星 · 爱的表达方式       │
│ ...                         │
└─────────────────────────────┘
```

### 理由
- 紧凑网格信息密度过高，阅读负担重。
- 垂直布局给予每个维度足够的展示空间。
- 与"探索自我"的卡片风格保持一致。

---

## 4. 内容深度增强

### 当前问题
- 组合盘各字段仅 1 句话，过于简略。
- 对比盘 sensitivity_panel 缺乏深度解读。

### 优化方案

**组合盘 Prompt 调整**：
```
- core.summary 的 outer/inner/growth 各 2-3 句，深入阐述。
- karmic 增加 nodes（北交南交）和 chiron（凯龙）字段。
- daily.maintenance_list 增加到 5-8 条具体可执行建议。
```

**对比盘 Prompt 调整**：
```
- sensitivity_panel 每项要求包含：
  - mode: 行为模式（1-2 句）
  - fear: 深层恐惧（1-2 句）
  - need: 核心需求（1-2 句）
- main_items 每条要求更详细的解读。
```

### 理由
- 用户期望获得深度洞察，而非泛泛而谈。
- 更详细的内容增加用户对报告的信任度。
- 与 Ask Oracle 的深度分析风格保持一致。

---

## 5. 相位图例翻译

### 映射表

| 英文 | 中文 | 含义 |
|------|------|------|
| CONJUNCTION | 合相 | 0° |
| OPPOSITION | 对冲 | 180° |
| SQUARE | 刑相 | 90° |
| TRINE | 三合 | 120° |
| SEXTILE | 六合 | 60° |

### 实现位置
- `AstroChart.tsx` 中的图例渲染。
- `constants.ts` 中的 i18n 翻译。

---

## 6. 依赖关系

```
optimize-synastry-report (进行中)
         │
         ▼
optimize-synastry-ux (本提案)
         │
         ├── 依赖 A/B 替换基础设施
         └── 可并行：i18n 补全、术语通俗化
```

### 可并行任务
- i18n 翻译补全
- 术语通俗化
- 排版调整

### 需顺序执行
- AI 姓名替换 → 需先完成 `optimize-synastry-report` 的 prompt 修改
- 内容深度增强 → 需在姓名替换完成后进行
