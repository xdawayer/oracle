# ä»˜è´¹ä¸è®¢é˜…ç³»ç»Ÿ - è®¾è®¡æ–‡æ¡£

## 1. å®šä»·ç­–ç•¥

### 1.1 å®šä»·åŸåˆ™

- **ç›®æ ‡å¸‚åœº**ï¼šæ¬§ç¾ç”¨æˆ·ä¸ºä¸»
- **ç­–ç•¥**ï¼šä½ä»·è·å®¢ + é«˜é¢‘ä»˜è´¹ + æ€§ä»·æ¯”å·®å¼‚åŒ–
- **æ¯›åˆ©ç›®æ ‡**ï¼šä¿å®ˆå‹ 80%+ï¼ˆæˆæœ¬ Ã— 5ï¼‰
- **å‚è€ƒç«å“**ï¼šCo-Starï¼ˆå®æƒ è·¯çº¿ï¼‰

### 1.2 AI Token æˆæœ¬åŸºå‡†ï¼ˆDeepSeek APIï¼‰

| å†…å®¹ç±»å‹ | Token æ¶ˆè€— | API æˆæœ¬ | æœ€ä½å®šä»·ï¼ˆ80%æ¯›åˆ©ï¼‰|
|---------|-----------|---------|-------------------|
| å…ƒç´ /è¡Œæ˜Ÿè¯¦æƒ… | 500-800 | $0.002 | $0.01 â†’ $0.49 |
| Ask å•æ¬¡é—®ç­” | 1000-1500 | $0.004 | $0.02 â†’ $0.99 |
| åˆç›˜å• Tab | 2000-3000 | $0.008 | $0.04 â†’ $1.99 |
| å®Œæ•´åˆç›˜æŠ¥å‘Š | 8000-12000 | $0.03 | $0.15 â†’ $3.99 |
| æœˆè¿æŠ¥å‘Š | 5000-8000 | $0.02 | $0.10 â†’ $1.99 |
| å¹´åº¦è¿åŠ¿æŠ¥å‘Š | 15000-25000 | $0.06 | $0.30 â†’ $7.99 |
| ä¸“é¢˜æŠ¥å‘Š | 10000-20000 | $0.05 | $0.25 â†’ $4.99 |
| CBT æ—¥è®°åˆ†æ | 1500-2500 | $0.006 | $0.03 â†’ $0.99 |

---

## 2. æƒç›Šè®¾è®¡

### 2.1 å…è´¹æƒç›Šï¼ˆFree Tierï¼‰

| åŠŸèƒ½ | å…è´¹é¢åº¦ | è¯´æ˜ |
|-----|---------|------|
| æœ¬å‘½ç›˜å¯è§†åŒ– | âœ“ æ— é™ | æ ¸å¿ƒé’©å­ï¼Œæ°¸ä¹…å…è´¹ |
| æŠ€æœ¯æ•°æ®è¡¨æ ¼ | âœ“ æ— é™ | è¡Œæ˜Ÿ/ç›¸ä½/å®«ä½è¡¨æ ¼ |
| æ—¥è¿æ‘˜è¦ | âœ“ ç®€ç‰ˆ | ä¸€å¥è¯è¿åŠ¿ |
| Ask é—®ç­” | 3 æ¬¡ | é¦–æ¬¡ä½¿ç”¨è¯•ç”¨ |
| è¯¦æƒ…è§£è¯» | 3 æ¬¡ | å…ƒç´ /è¡Œæ˜Ÿ/ç›¸ä½ç‚¹å‡»è§£è¯» |
| åˆç›˜æ¦‚è§ˆ | 1 æ¬¡ | ä»…æ€»è§ˆ Tab |
| CBT æ—¥è®°è®°å½• | âœ“ æ— é™ | è®°å½•å…è´¹ï¼ŒAI åˆ†æä»˜è´¹ |

### 2.2 è®¢é˜…æƒç›Šï¼ˆSubscriberï¼‰

**å®šä»·ï¼š$6.99/æœˆ æˆ– $49.99/å¹´ï¼ˆçº¦ $4.17/æœˆï¼Œçœ 29%ï¼‰**

| æƒç›Š | é¢åº¦ |
|-----|------|
| Ask é—®ç­” | âœ“ æ— é™ |
| è¯¦æƒ…è§£è¯» | âœ“ æ— é™ |
| æ—¥è¿å®Œæ•´ç‰ˆ | âœ“ æ— é™ |
| åˆç›˜è§£è¯» | 5 æ¬¡/æœˆï¼ˆæ‰€æœ‰ Tabï¼‰ |
| CBT æ—¥è®° AI åˆ†æ | âœ“ æ— é™ |
| æœˆè¿æŠ¥å‘Š | æ¯æœˆ 1 ä»½å…è´¹ |
| ä»˜è´¹æŠ¥å‘ŠæŠ˜æ‰£ | 30% off |
| è®¢é˜…ä¸“å±å†…å®¹ | æå‰ä½“éªŒæ–°åŠŸèƒ½ |

### 2.3 å•æ¬¡è´­ä¹°å®šä»·

#### æ¿€è¿›å®šä»·ï¼ˆæ¨èï¼Œæ–¹æ¡ˆ Aï¼‰

| å•†å“ | å•ä»· | è¯´æ˜ |
|-----|------|------|
| Ask å•æ¬¡ | $0.99 | å•æ¬¡é—®ç­” |
| è¯¦æƒ…è§£è¯»åŒ… | $2.99 | 10 æ¬¡è§£è¯» |
| åˆç›˜å®Œæ•´è§£è¯» | $3.99 | å…¨éƒ¨ Tab ä¸€æ¬¡æ€§è§£é” |
| CBT æ—¥è®°åˆ†æ | $0.99 | å•æ¬¡åˆ†æ |
| æœˆè¿æŠ¥å‘Š | $1.99 | å½“æœˆè¿åŠ¿ |
| å¹´åº¦è¿åŠ¿æŠ¥å‘Š | $7.99 | å®Œæ•´å¹´åº¦é¢„æµ‹ |
| äº‹ä¸šæŠ¥å‘Š | $4.99 | èŒä¸šå‘å±•åˆ†æ |
| è´¢å¯ŒæŠ¥å‘Š | $4.99 | è´¢è¿åˆ†æ |
| çˆ±æƒ…æŠ¥å‘Š | $4.99 | æ„Ÿæƒ…è¿åŠ¿ |
| åœŸæ˜Ÿå›å½’æŠ¥å‘Š | $6.99 | 27-30å²ä¸“å± |

#### ä¿å®ˆå®šä»·ï¼ˆå¤‡é€‰ï¼Œæ–¹æ¡ˆ Bï¼‰

| å•†å“ | å•ä»· |
|-----|------|
| Ask å•æ¬¡ | $1.49 |
| è¯¦æƒ…è§£è¯»åŒ… | $3.99 |
| åˆç›˜å®Œæ•´è§£è¯» | $5.99 |
| CBT æ—¥è®°åˆ†æ | $1.49 |
| æœˆè¿æŠ¥å‘Š | $2.99 |
| å¹´åº¦è¿åŠ¿æŠ¥å‘Š | $12.99 |
| ä¸“é¢˜æŠ¥å‘Š | $6.99-9.99 |

> æ³¨ï¼šæ‰€æœ‰å®šä»·æ”¯æŒåå°é…ç½®ï¼Œå¯æ ¹æ®æ•°æ®è°ƒæ•´ã€‚

---

## 3. ç”¨æˆ·è´¦æˆ·ä½“ç³»

### 3.1 æ³¨å†Œ/ç™»å½•æ–¹å¼

| æ–¹å¼ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|-----|-------|------|
| Google Sign-In | P0 | æ¬§ç¾æœ€å¸¸ç”¨ |
| Apple Sign-In | P0 | iOS App Store å¿…é¡» |
| Email + Password | P1 | ä¼ ç»Ÿå¤‡é€‰ |
| Magic Link | P2 | æ— å¯†ç ç™»å½•ï¼ˆå¯é€‰ï¼‰ |

### 3.2 ç”¨æˆ·æ•°æ®æ¨¡å‹

```typescript
interface User {
  id: string;                    // UUID
  email: string;
  name?: string;
  avatar?: string;
  provider: 'google' | 'apple' | 'email';
  providerId?: string;

  // å‡ºç”Ÿä¿¡æ¯ï¼ˆä» localStorage è¿ç§»ï¼‰
  birthProfile?: {
    birthDate: string;
    birthTime?: string;
    birthCity: string;
    lat?: number;
    lon?: number;
    timezone: string;
    accuracyLevel: 'exact' | 'time_unknown' | 'approximate';
  };

  // åå¥½è®¾ç½®
  preferences: {
    theme: 'dark' | 'light';
    language: 'zh' | 'en';
  };

  createdAt: Date;
  updatedAt: Date;
}
```

### 3.3 æ•°æ®è¿ç§»ç­–ç•¥

1. ç”¨æˆ·ç™»å½•æ—¶æ£€æµ‹ localStorage æ˜¯å¦æœ‰ `astro_user` æ•°æ®
2. å¼¹çª—æç¤ºï¼š"æ£€æµ‹åˆ°æœ¬åœ°æ•°æ®ï¼Œæ˜¯å¦åŒæ­¥åˆ°äº‘ç«¯ï¼Ÿ"
3. ç”¨æˆ·ç¡®è®¤åè¿ç§»æ•°æ®ï¼Œæ¸…é™¤ localStorage
4. åç»­è®¿é—®ä¼˜å…ˆä½¿ç”¨äº‘ç«¯æ•°æ®

---

## 4. æ”¯ä»˜ç³»ç»Ÿ

### 4.1 æ”¯ä»˜æ¸ é“

| æ¸ é“ | é˜¶æ®µ | ç”¨é€” |
|-----|------|-----|
| Stripe | MVP | Web è®¢é˜… + å•æ¬¡è´­ä¹° |
| Apple IAP | Phase 2 | iOS App |
| Google Play Billing | Phase 2 | Android App |

### 4.2 Stripe é›†æˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend  â”‚â”€â”€â”€â”€â–¶â”‚   Backend   â”‚â”€â”€â”€â”€â–¶â”‚   Stripe    â”‚
â”‚  (React)    â”‚     â”‚  (Express)  â”‚     â”‚    API      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â”‚  1. ç‚¹å‡»è®¢é˜…      â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
       â”‚                   â”‚ 2. åˆ›å»º Checkout  â”‚
       â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                   â”‚                   â”‚
       â”‚  3. è¿”å› URL      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
       â”‚                   â”‚                   â”‚
       â”‚  4. è·³è½¬ Stripe   â”‚                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                   â”‚                   â”‚
       â”‚                   â”‚ 5. Webhook é€šçŸ¥   â”‚
       â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                   â”‚                   â”‚
       â”‚  6. æ›´æ–°æƒç›Š      â”‚                   â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
```

### 4.3 è®¢é˜…çŠ¶æ€ç®¡ç†

```typescript
interface Subscription {
  id: string;
  userId: string;
  stripeSubscriptionId: string;
  stripeCustomerId: string;

  plan: 'monthly' | 'yearly';
  status: 'active' | 'canceled' | 'past_due' | 'expired';

  currentPeriodStart: Date;
  currentPeriodEnd: Date;
  cancelAtPeriodEnd: boolean;

  // è®¢é˜…å†…æƒç›Šä½¿ç”¨é‡
  usage: {
    synastryReads: number;      // åˆç›˜ä½¿ç”¨æ¬¡æ•°
    monthlyReportClaimed: boolean;
  };

  createdAt: Date;
  updatedAt: Date;
}
```

### 4.4 å•æ¬¡è´­ä¹°è®°å½•

```typescript
interface Purchase {
  id: string;
  userId: string;
  stripePaymentIntentId: string;

  productType: 'ask' | 'detail_pack' | 'synastry' | 'cbt_analysis' | 'report';
  productId?: string;           // æŠ¥å‘Šç±»å‹ ID
  amount: number;               // ç¾åˆ†
  currency: 'usd';

  status: 'pending' | 'completed' | 'failed' | 'refunded';

  // å¯¹äºæ¶ˆè€—å“ï¼ˆå¦‚ Askï¼‰ï¼Œè®°å½•å‰©ä½™æ¬¡æ•°
  quantity?: number;
  consumed?: number;

  createdAt: Date;
}
```

---

## 5. æƒç›Šæ ¡éªŒç³»ç»Ÿ

### 5.1 æ ¡éªŒæµç¨‹

```
ç”¨æˆ·è¯·æ±‚ AI å†…å®¹
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥æ˜¯å¦ç™»å½•      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ å·²ç™»å½•   â”‚ æœªç™»å½• â”€â”€â–¶ æ£€æŸ¥ localStorage å…è´¹é¢åº¦
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â”‚
         â”‚                         â–¼
         â–¼                   é¢åº¦ç”¨å®Œ â”€â”€â–¶ æ˜¾ç¤ºç™»å½•/ä»˜è´¹å¢™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥è®¢é˜…çŠ¶æ€      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ è®¢é˜…ä¸­   â”‚ éè®¢é˜… â”€â”€â–¶ æ£€æŸ¥å•æ¬¡è´­ä¹°é¢åº¦
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â”‚
         â”‚                         â–¼
         â–¼                   é¢åº¦ç”¨å®Œ â”€â”€â–¶ æ˜¾ç¤ºä»˜è´¹å¢™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥è®¢é˜…å†…é¢åº¦    â”‚
â”‚ ï¼ˆå¦‚åˆç›˜ 5æ¬¡/æœˆï¼‰ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ æœ‰é¢åº¦   â”‚ æ— é¢åº¦ â”€â”€â–¶ æ˜¾ç¤ºè´­ä¹°æç¤º
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    æ‰§è¡Œè¯·æ±‚ï¼Œæ‰£å‡é¢åº¦
```

### 5.2 å‰ç«¯æƒç›Šä¸Šä¸‹æ–‡

```typescript
interface Entitlements {
  isLoggedIn: boolean;
  isSubscriber: boolean;
  subscription?: {
    plan: 'monthly' | 'yearly';
    expiresAt: Date;
    synastryReadsLeft: number;
    monthlyReportClaimed: boolean;
  };

  // å…è´¹/è´­ä¹°é¢åº¦
  freeAskLeft: number;
  freeDetailLeft: number;
  purchasedAsk: number;
  purchasedDetailPack: number;

  // å·²è´­ä¹°çš„æŠ¥å‘Š
  purchasedReports: string[];
}
```

### 5.3 ä»˜è´¹å¢™ç»„ä»¶

```typescript
interface PaywallProps {
  feature: 'ask' | 'detail' | 'synastry' | 'cbt_analysis' | 'report';
  reportType?: string;
  onPurchase: () => void;
  onSubscribe: () => void;
  onClose: () => void;
}

// æ˜¾ç¤ºé€»è¾‘ï¼š
// 1. æ˜¾ç¤ºåŠŸèƒ½ä»·å€¼è¯´æ˜
// 2. å•æ¬¡è´­ä¹°ä»·æ ¼ + æŒ‰é’®
// 3. "æˆ– è®¢é˜…è§£é”å…¨éƒ¨" + è®¢é˜…ä»·æ ¼
// 4. è®¢é˜…å¯¹æ¯”è¡¨ï¼ˆå•æ¬¡ vs è®¢é˜…ï¼‰
```

---

## 6. ä»˜è´¹æŠ¥å‘Šè®¾è®¡

### 6.1 æŠ¥å‘Šå¼€å‘ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | æŠ¥å‘Š | å•ä»· | è®¢é˜…åŒ…å« | å¼€å‘å¤æ‚åº¦ |
|-------|-----|------|---------|-----------|
| P0 | å¹´åº¦è¿åŠ¿æŠ¥å‘Š | $7.99 | 30% æŠ˜æ‰£ | ä¸­ |
| P0 | æœˆè¿æŠ¥å‘Š | $1.99 | æ¯æœˆ 1 ä»½å…è´¹ | ä½ |
| P1 | åˆç›˜æ·±åº¦æŠ¥å‘Š | $3.99 | 5æ¬¡/æœˆ | ä½ï¼ˆå·²æœ‰åŸºç¡€ï¼‰ |
| P1 | äº‹ä¸š/èŒä¸šæŠ¥å‘Š | $4.99 | 30% æŠ˜æ‰£ | ä¸­ |
| P2 | è´¢å¯Œ/é‡‘é’±æŠ¥å‘Š | $4.99 | 30% æŠ˜æ‰£ | ä¸­ |
| P2 | åœŸæ˜Ÿå›å½’æŠ¥å‘Š | $6.99 | 30% æŠ˜æ‰£ | ä½ |
| P3 | 3/6/12æœˆè¡Œè¿é¢„æµ‹ | $2.99-6.99 | 30% æŠ˜æ‰£ | ä¸­-é«˜ |

### 6.2 æŠ¥å‘Šè¾“å‡ºå½¢å¼

#### å½¢å¼ 1ï¼šçº¯æ–‡å­—ï¼ˆWeb å±•ç¤ºï¼‰
- ä¼˜ç‚¹ï¼šå¼€å‘å¿«ï¼ŒSEO å‹å¥½
- ç¼ºç‚¹ï¼šä»·å€¼æ„Ÿä½
- é€‚ç”¨ï¼šæœˆè¿ã€æ—¥è¿è¯¦æƒ…

#### å½¢å¼ 2ï¼šPDF ä¸‹è½½
- ä¼˜ç‚¹ï¼šä»·å€¼æ„Ÿé«˜ï¼Œå¯åˆ†äº«/æ‰“å°
- ç¼ºç‚¹ï¼šéœ€è¦ PDF ç”Ÿæˆåº“
- é€‚ç”¨ï¼šå¹´åº¦æŠ¥å‘Šã€ä¸“é¢˜æŠ¥å‘Š
- æŠ€æœ¯ï¼špuppeteer æˆ– @react-pdf/renderer

#### å½¢å¼ 3ï¼šäº¤äº’å¼æŠ¥å‘Š
- ä¼˜ç‚¹ï¼šæœ€ä½³ä½“éªŒï¼Œå¯ä¸ªæ€§åŒ–
- ç¼ºç‚¹ï¼šå¼€å‘æˆæœ¬é«˜
- é€‚ç”¨ï¼šåˆç›˜æ·±åº¦æŠ¥å‘Š
- è®¾è®¡æ–¹å‘ï¼šåˆ†ç« èŠ‚å±•å¼€ã€æ—¶é—´è½´ã€å¯è§†åŒ–å›¾è¡¨

**MVP ç­–ç•¥**ï¼šP0 æŠ¥å‘Šä½¿ç”¨ Web + PDF åŒå½¢å¼ï¼Œäº¤äº’å¼æŠ¥å‘Šæ”¾ Phase 2ã€‚

### 6.3 å¹´åº¦è¿åŠ¿æŠ¥å‘Šç»“æ„ï¼ˆç¤ºä¾‹ï¼‰

```markdown
# 2026 å¹´åº¦è¿åŠ¿æŠ¥å‘Š - {ç”¨æˆ·å}

## æ€»è§ˆ
- å¹´åº¦å…³é”®è¯ï¼ˆ3 ä¸ªï¼‰
- å¹´åº¦ä¸»é¢˜æ¦‚è¿°ï¼ˆ200-300å­—ï¼‰
- é‡è¦è¡Œè¿æç¤º

## å­£åº¦è¿åŠ¿
### Q1 (1-3æœˆ)
- æ•´ä½“è¿åŠ¿
- é‡ç‚¹äº‹é¡¹
- å»ºè®®è¡ŒåŠ¨

### Q2 (4-6æœˆ)
...

## ä¸“é¢˜è¿åŠ¿
### äº‹ä¸šå‘å±•
### æ„Ÿæƒ…å…³ç³»
### è´¢åŠ¡çŠ¶å†µ
### å¥åº·æé†’

## é‡è¦æ—¥æœŸ
- æ°´é€†æœŸé—´
- æ—¥æœˆé£Ÿ
- è¡Œæ˜Ÿæ¢åº§

## å¹´åº¦å»ºè®®
- 3 æ¡æ ¸å¿ƒå»ºè®®
- éœ€è¦é¿å¼€çš„é™·é˜±
```

---

## 7. æ•°æ®åº“è®¾è®¡

### 7.1 è¡¨ç»“æ„

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  name VARCHAR(255),
  avatar TEXT,
  provider VARCHAR(20) NOT NULL, -- google, apple, email
  provider_id VARCHAR(255),
  password_hash VARCHAR(255),    -- ä»… email æ³¨å†Œ

  birth_profile JSONB,
  preferences JSONB DEFAULT '{"theme": "dark", "language": "en"}',

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- è®¢é˜…è¡¨
CREATE TABLE subscriptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  stripe_subscription_id VARCHAR(255) UNIQUE,
  stripe_customer_id VARCHAR(255),

  plan VARCHAR(20) NOT NULL,     -- monthly, yearly
  status VARCHAR(20) NOT NULL,   -- active, canceled, past_due, expired

  current_period_start TIMESTAMPTZ,
  current_period_end TIMESTAMPTZ,
  cancel_at_period_end BOOLEAN DEFAULT FALSE,

  usage JSONB DEFAULT '{"synastryReads": 0, "monthlyReportClaimed": false}',

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- è´­ä¹°è®°å½•è¡¨
CREATE TABLE purchases (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  stripe_payment_intent_id VARCHAR(255),

  product_type VARCHAR(50) NOT NULL,
  product_id VARCHAR(100),
  amount INTEGER NOT NULL,        -- ç¾åˆ†
  currency VARCHAR(3) DEFAULT 'usd',

  status VARCHAR(20) NOT NULL,
  quantity INTEGER DEFAULT 1,
  consumed INTEGER DEFAULT 0,

  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- æŠ¥å‘Šè¡¨
CREATE TABLE reports (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,

  report_type VARCHAR(50) NOT NULL,
  title VARCHAR(255),
  content JSONB,
  pdf_url TEXT,

  birth_profile JSONB,           -- ç”Ÿæˆæ—¶çš„å‡ºç”Ÿä¿¡æ¯å¿«ç…§

  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- å…è´¹é¢åº¦è¡¨ï¼ˆæœªç™»å½•ç”¨æˆ·ï¼‰
CREATE TABLE free_usage (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  device_fingerprint VARCHAR(255) UNIQUE,
  ip_address INET,

  ask_used INTEGER DEFAULT 0,
  detail_used INTEGER DEFAULT 0,
  synastry_used INTEGER DEFAULT 0,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 7.2 ç´¢å¼•

```sql
CREATE INDEX idx_subscriptions_user_id ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
CREATE INDEX idx_purchases_user_id ON purchases(user_id);
CREATE INDEX idx_reports_user_id ON reports(user_id);
CREATE INDEX idx_free_usage_fingerprint ON free_usage(device_fingerprint);
```

---

## 8. API è®¾è®¡

### 8.1 è®¤è¯ API

```
POST /api/auth/google      - Google ç™»å½•
POST /api/auth/apple       - Apple ç™»å½•
POST /api/auth/register    - Email æ³¨å†Œ
POST /api/auth/login       - Email ç™»å½•
POST /api/auth/logout      - ç™»å‡º
GET  /api/auth/me          - è·å–å½“å‰ç”¨æˆ·
PUT  /api/auth/profile     - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
POST /api/auth/migrate     - è¿ç§» localStorage æ•°æ®
```

### 8.2 æ”¯ä»˜ API

```
POST /api/payment/create-checkout        - åˆ›å»º Stripe Checkout
POST /api/payment/create-portal          - åˆ›å»º Stripe Customer Portal
POST /api/payment/webhook                - Stripe Webhook
GET  /api/payment/subscription           - è·å–è®¢é˜…çŠ¶æ€
GET  /api/payment/purchases              - è·å–è´­ä¹°è®°å½•
POST /api/payment/purchase               - å•æ¬¡è´­ä¹°
```

### 8.3 æƒç›Š API

```
GET  /api/entitlements                   - è·å–æƒç›ŠçŠ¶æ€
POST /api/entitlements/consume           - æ¶ˆè€—æƒç›Šï¼ˆAsk/è¯¦æƒ…ç­‰ï¼‰
GET  /api/entitlements/check/:feature    - æ£€æŸ¥ç‰¹å®šåŠŸèƒ½æƒé™
```

### 8.4 æŠ¥å‘Š API

```
GET  /api/reports                        - è·å–æŠ¥å‘Šåˆ—è¡¨
GET  /api/reports/:id                    - è·å–æŠ¥å‘Šè¯¦æƒ…
POST /api/reports/generate               - ç”ŸæˆæŠ¥å‘Šï¼ˆä»˜è´¹ï¼‰
GET  /api/reports/:id/pdf                - ä¸‹è½½ PDF
```

---

## 9. å‰ç«¯é¡µé¢è®¾è®¡

### 9.1 æ–°å¢é¡µé¢

| é¡µé¢ | è·¯ç”± | è¯´æ˜ |
|-----|------|------|
| ç™»å½•/æ³¨å†Œ | /auth | ç»Ÿä¸€è®¤è¯é¡µ |
| è®¢é˜…ç®¡ç† | /subscription | æŸ¥çœ‹/ç®¡ç†è®¢é˜… |
| è´­ä¹°è®°å½• | /purchases | å†å²è´­ä¹° |
| æŠ¥å‘Šåˆ—è¡¨ | /reports | å·²è´­æŠ¥å‘Š |
| æŠ¥å‘Šè¯¦æƒ… | /reports/:id | æŸ¥çœ‹æŠ¥å‘Š |
| æŠ¥å‘Šå•†åº— | /store | è´­ä¹°æŠ¥å‘Š |

### 9.2 ä»˜è´¹å¢™è§¦å‘ç‚¹

| åŠŸèƒ½ | è§¦å‘æ¡ä»¶ |
|-----|---------|
| Ask é—®ç­” | å…è´¹æ¬¡æ•°ç”¨å®Œ |
| è¯¦æƒ…è§£è¯» | å…è´¹æ¬¡æ•°ç”¨å®Œ |
| åˆç›˜ Tab | éè®¢é˜…ç”¨æˆ·ç‚¹å‡»éæ€»è§ˆ Tab |
| CBT AI åˆ†æ | æ¯æ¬¡ç‚¹å‡»åˆ†æ |
| æ—¥è¿è¯¦æƒ… | éè®¢é˜…ç”¨æˆ· |
| æŠ¥å‘Š | æœªè´­ä¹°è¯¥æŠ¥å‘Š |

### 9.3 å‡çº§è®¢é˜…æŒ‰é’®

å…¨å±€æ˜¾ç¤ºå‡çº§å…¥å£ï¼Œå‚è€ƒ ChatGPT çš„å‡çº§æŒ‰é’®è®¾è®¡ï¼š

**æŒ‰é’®ä½ç½®**ï¼š
- é¡¶éƒ¨å¯¼èˆªæ å³ä¾§ï¼ˆç”¨æˆ·å¤´åƒæ—ï¼‰
- ä¾§è¾¹æ åº•éƒ¨ï¼ˆå¦‚æœ‰ï¼‰
- ä»˜è´¹å¢™å¼¹çª—å†…

**æŒ‰é’®æ ·å¼**ï¼š
```tsx
// å…è´¹ç”¨æˆ·æ˜¾ç¤º
<button className="upgrade-btn">
  <SparklesIcon />
  Upgrade to Pro
</button>

// è®¢é˜…ç”¨æˆ·æ˜¾ç¤º
<button className="manage-btn">
  <CrownIcon />
  Pro Plan
</button>
```

**æŒ‰é’®çŠ¶æ€**ï¼š
| ç”¨æˆ·çŠ¶æ€ | æŒ‰é’®æ–‡æ¡ˆ | ç‚¹å‡»è¡Œä¸º |
|---------|---------|---------|
| æœªç™»å½• | "Upgrade" | æ‰“å¼€ç™»å½•å¼¹çª— â†’ å‡çº§å¼¹çª— |
| å…è´¹ç”¨æˆ· | "Upgrade to Pro" | æ‰“å¼€å‡çº§å¼¹çª— |
| è®¢é˜…ç”¨æˆ· | "Pro Plan" | æ‰“å¼€è®¢é˜…ç®¡ç†å¼¹çª— |
| è®¢é˜…å³å°†åˆ°æœŸ | "Renew Pro" | æ‰“å¼€ç»­è´¹å¼¹çª— |

### 9.4 å‡çº§å¼¹çª—è®¾è®¡ï¼ˆUpgrade Modalï¼‰

å‚è€ƒ ChatGPT Plus å‡çº§å¼¹çª—ï¼Œè®¾è®¡å…¨å± Modalï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Ã—]                                                        â”‚
â”‚                                                             â”‚
â”‚              âœ¨ Upgrade to AstroMind Pro âœ¨                 â”‚
â”‚                                                             â”‚
â”‚         Unlock the full power of your cosmic insights       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚      FREE           â”‚  â”‚    PRO â­ BEST      â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚                     â”‚          â”‚
â”‚  â”‚  Basic natal chart  â”‚  â”‚  Everything in Free â”‚          â”‚
â”‚  â”‚  3 Ask questions    â”‚  â”‚  âœ“ Unlimited Ask    â”‚          â”‚
â”‚  â”‚  3 Detail readings  â”‚  â”‚  âœ“ Unlimited Detail â”‚          â”‚
â”‚  â”‚  Daily summary      â”‚  â”‚  âœ“ Full Daily       â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚  âœ“ 5 Synastry/mo    â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚  âœ“ Monthly Report   â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚  âœ“ 30% off Reports  â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚                     â”‚          â”‚
â”‚  â”‚      $0/mo          â”‚  â”‚    $6.99/mo         â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚    or $49.99/year   â”‚          â”‚
â”‚  â”‚                     â”‚  â”‚    (Save 29%)       â”‚          â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚
â”‚  â”‚  â”‚ Current Plan  â”‚  â”‚  â”‚  â”‚ Upgrade Now   â”‚  â”‚          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â”‚              ğŸ’¡ Cancel anytime. No commitment.              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¼¹çª—ç»„ä»¶æ¥å£**ï¼š

```typescript
interface UpgradeModalProps {
  isOpen: boolean;
  onClose: () => void;
  source?: 'header' | 'paywall' | 'feature';  // æ¥æºè¿½è¸ª
  highlightFeature?: string;  // é«˜äº®ç‰¹å®šåŠŸèƒ½ï¼ˆä»ä»˜è´¹å¢™è§¦å‘æ—¶ï¼‰
}

// ä½¿ç”¨ç¤ºä¾‹
<UpgradeModal
  isOpen={showUpgrade}
  onClose={() => setShowUpgrade(false)}
  source="paywall"
  highlightFeature="ask"
/>
```

**å¼¹çª—å†…å®¹åŒºå—**ï¼š

1. **æ ‡é¢˜åŒº**ï¼šå“ç‰Œ Logo + "Upgrade to Pro" + å‰¯æ ‡é¢˜
2. **å¯¹æ¯”å¡ç‰‡**ï¼šFree vs Pro åŒæ å¯¹æ¯”
3. **ä»·æ ¼é€‰æ‹©**ï¼šæœˆä»˜ / å¹´ä»˜åˆ‡æ¢ï¼ˆå¹´ä»˜é«˜äº®æ˜¾ç¤ºèŠ‚çœé‡‘é¢ï¼‰
4. **CTA æŒ‰é’®**ï¼š"Upgrade Now" ä¸»æŒ‰é’®
5. **ä¿¡ä»»æ ‡è¯†**ï¼š"Cancel anytime" + å®‰å…¨æ”¯ä»˜å›¾æ ‡
6. **åŠŸèƒ½è¯¦æƒ…**ï¼šå¯å±•å¼€çš„å®Œæ•´åŠŸèƒ½åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰

**å“åº”å¼è®¾è®¡**ï¼š
- Desktopï¼šåŒæ å¯¹æ¯”å¡ç‰‡
- Mobileï¼šå•æ å †å ï¼ŒPro å¡ç‰‡åœ¨ä¸Š

### 9.5 è®¢é˜…ç®¡ç†å¼¹çª—ï¼ˆSubscription Modalï¼‰

è®¢é˜…ç”¨æˆ·ç‚¹å‡» "Pro Plan" æŒ‰é’®æ—¶æ˜¾ç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Ã—]                        Pro Plan                        â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â­ You're on the Pro Monthly Plan                   â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  Next billing: Jan 15, 2026                         â”‚   â”‚
â”‚  â”‚  Amount: $6.99                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  This Month's Usage                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Synastry Reads    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  3/5 used             â”‚   â”‚
â”‚  â”‚  Monthly Report    âœ“ Claimed                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Manage Billing  â”‚  â”‚ Switch to Year  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚               Cancel Subscription                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç®¡ç†åŠŸèƒ½**ï¼š
- æŸ¥çœ‹å½“å‰è®¡åˆ’å’Œä¸‹æ¬¡æ‰£æ¬¾æ—¥æœŸ
- æŸ¥çœ‹æœ¬æœˆæƒç›Šä½¿ç”¨æƒ…å†µ
- åˆ‡æ¢åˆ°å¹´ä»˜ï¼ˆæ˜¾ç¤ºèŠ‚çœé‡‘é¢ï¼‰
- è·³è½¬ Stripe Customer Portal ç®¡ç†æ”¯ä»˜æ–¹å¼
- å–æ¶ˆè®¢é˜…ï¼ˆæ˜¾ç¤ºæŒ½ç•™æç¤ºï¼‰

### 9.6 å–æ¶ˆæŒ½ç•™å¼¹çª—

ç”¨æˆ·ç‚¹å‡»å–æ¶ˆè®¢é˜…æ—¶çš„æŒ½ç•™æµç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                  ğŸ˜¢ We're sad to see you go                 â”‚
â”‚                                                             â”‚
â”‚  Before you cancel, here's what you'll lose:                â”‚
â”‚                                                             â”‚
â”‚  âœ— Unlimited Ask questions                                  â”‚
â”‚  âœ— Unlimited detail readings                                â”‚
â”‚  âœ— 5 synastry readings per month                           â”‚
â”‚  âœ— Free monthly report                                      â”‚
â”‚  âœ— 30% discount on all reports                             â”‚
â”‚                                                             â”‚
â”‚  Your subscription will remain active until Jan 15, 2026    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ Stay and get 20% off your next 3 months!        â”‚   â”‚
â”‚  â”‚     Use code: STAY20                                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚         Keep My Subscription               â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚              No thanks, cancel anyway â†’                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. å®‰å…¨è€ƒè™‘

### 10.1 é˜²æ»¥ç”¨

- è®¾å¤‡æŒ‡çº¹è¿½è¸ªå…è´¹é¢åº¦
- IP é™æµ
- æ³¨å†Œéœ€é‚®ç®±éªŒè¯

### 10.2 æ”¯ä»˜å®‰å…¨

- Stripe Webhook ç­¾åéªŒè¯
- æœåŠ¡ç«¯éªŒè¯è®¢é˜…çŠ¶æ€
- å…³é”®æ“ä½œè®°å½•å®¡è®¡æ—¥å¿—

### 10.3 æ•°æ®å®‰å…¨

- å¯†ç ä½¿ç”¨ bcrypt åŠ ç›å“ˆå¸Œ
- JWT Token çŸ­æœŸæœ‰æ•ˆ + Refresh Token
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
